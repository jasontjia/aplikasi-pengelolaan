
//Fungsi untuk menambahkan barang masuk
if (isset($_POST['barangmasuk'])) {
    $barangnya = $_POST['barangnya'];
    $harga_beli = $_POST['harga_beli'];
    $nama_supplier = $_POST['nama_supplier'];
    $satuan = $_POST['satuan'];
    $qty = $_POST['qty'];

    $cekstokbarang = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$barangnya'");
    $ambildatanya = mysqli_fetch_array($cekstokbarang);

    $stoksekarang = $ambildatanya['stock'];
    $tambahkanstoksekarangdenganquantity = $stoksekarang + $qty;

    $addtomasuk = mysqli_query($conn, "INSERT INTO `barang-masuk` (idbarang, harga_beli, nama_supplier, qty) VALUES ('$barangnya', '$harga_beli', '$nama_supplier', '$qty')");
    $updatestokmasuk = mysqli_query($conn, "UPDATE stok SET stock = '$tambahkanstoksekarangdenganquantity' WHERE idbarang = '$barangnya'");

    if ($addtomasuk && $updatestokmasuk) {
        echo '<script>alert("Berhasil Simpan Barang Masuk");window.location="barangmasuk.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk.php');
    }
}

// Fungsi mengubah barang masuk
if (isset($_POST['ubahbarangmasuk'])) {
    $idb = $_POST['idbarang'];
    $idm = $_POST['idmasuk'];
    $harga_beli = $_POST['harga_beli'];
    $nama_supplier = $_POST['nama_supplier'];
    $qty = $_POST['qty'];

    // Ambil stok sekarang dari tabel stock
    $lihatstok = mysqli_query($conn, "SELECT stock FROM stok WHERE idbarang='$idb'");
    $stoknya = mysqli_fetch_array($lihatstok);
    $stokskrg = $stoknya['stock'];

    // Ambil qty sekarang dari tabel masuk
    $qtyskrg = mysqli_query($conn, "SELECT qty FROM `barang-masuk` WHERE idmasuk = '$idm'");
    $qtynya =  mysqli_fetch_array($qtyskrg);
    $qtyskrg = $qtynya['qty'];

    // Menghitung selisih antara qty baru dan qty saat ini
    $selisih = $qty - $qtyskrg;

    // Menghitung stok baru
    $stokbaru = $stokskrg + $selisih;

    $kurangistoknya = mysqli_query($conn, "UPDATE stok SET stock = '$stokbaru' WHERE idbarang='$idb'");
    $ubahnya = mysqli_query($conn, "UPDATE `barang-masuk` SET qty='$qty', harga_beli='$harga_beli', nama_supplier='$nama_supplier' WHERE idmasuk = $idm");

    if ($kurangistoknya && $ubahnya) {
        echo '<script>alert("Berhasil Ubah Barang Masuk");window.location="barangmasuk.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk.php');
    }
}

//Fungsi untuk menambahkan barang keluar
if (isset($_POST['addbarangkeluar'])) {
    $barangnya = $_POST['barangnya'];
    $harga_jual = $_POST['harga_jual'];
    $penerima = $_POST['penerima'];
    $qty = $_POST['qty'];

    $cekstokbarang = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$barangnya'");
    $ambildatanya = mysqli_fetch_array($cekstokbarang);

    $stoksekarang = $ambildatanya['stock'];

    if ($stoksekarang >= $qty) {
        //apabila barang cukup
        $tambahkanstoksekarangdenganquantity = $stoksekarang - $qty;

        $addtokeluar = mysqli_query($conn, "INSERT INTO `barang-keluar` (idbarang, harga_jual, penerima, qty, total) VALUES ('$barangnya', '$harga_jual', '$penerima', '$qty')");
        $updatestokmasuk = mysqli_query($conn, "UPDATE stok SET stock = '$tambahkanstoksekarangdenganquantity' WHERE idbarang = '$barangnya'");

        if ($addtokeluar && $updatestokmasuk) {
            echo '<script>alert("Berhasil Simpan Barang Keluar");window.location="barangkeluar.php"</script>';
        } else {
            echo 'Gagal';
            header('location:barangkeluar.php');
        }
    } else {
        //apabila barang tidak cukup
        echo '
        <script>
            alert("Jumlah berang keluar saat ini sudah melebihi jumlah stok tersisa");
            window.location.href= keluar.php;
        </script>
        ';
    }
}

//Fungsi untuk mengubah barang keluar
if (isset($_POST['ubahbarangkeluar'])) {
    $idb = $_POST['idbarang'];
    $idk = $_POST['idkeluar'];
    $harga_jual = $_POST['harga_jual'];
    $penerima = $_POST['penerima'];
    $qty = $_POST['qty'];

    // Ambil stok sekarang dari tabel stock
    $lihatstok = mysqli_query($conn, "SELECT stock FROM `stok` WHERE idbarang='$idb'");
    $stoknya = mysqli_fetch_array($lihatstok);
    $stokskrg = $stoknya['stock'];

    // Ambil qty sekarang dari tabel masuk
    $qtyskrg = mysqli_query($conn, "SELECT qty FROM `barang-keluar` WHERE idkeluar = '$idk'");
    $qtynya =  mysqli_fetch_array($qtyskrg);
    $qtyskrg = $qtynya['qty'];

    if ($qty > $qtyskrg) {
        $selisih = $qty - $qtyskrg;
        $kurang = $stokskrg - $selisih;

        if ($selisih <= $stokskrg) {
            $kurangistoknya = mysqli_query($conn, "UPDATE stok SET stock = '$kurang' WHERE idbarang='$idb'");
            $ubahnya = mysqli_query($conn, "UPDATE `barang-keluar` SET qty='$qty', harga_jual='$harga_jual', penerima='$penerima' WHERE idkeluar = $idk");
            if ($kurangistoknya && $ubahnya) {
                echo '<script>alert("Berhasil Ubah Barang Keluar");window.location="barangkeluar.php"</script>';
            } else {
                echo 'Gagal';
                header('location:barangkeluar.php');
            }
        } else {
            echo '
            <script> alert ("Stok Tidak Cukup");
            window.location.href="barangkeluar.php";
            </script>
            ';
        }
    } else {
        $selisih = $qtyskrg - $qty;
        $kurang = $stokskrg + $selisih;
        $kurangistoknya = mysqli_query($conn, "UPDATE stok SET stock = '$kurang' WHERE idbarang='$idb'");
        $ubahnya = mysqli_query($conn, "UPDATE barang-keluar SET qty='$qty', harga_jual='$harga_jual', penerima='$penerima' WHERE idkeluar = $idk");
        if ($kurangistoknya && $ubahnya) {
            echo '<script>alert("Berhasil Ubah Barang Keluar");window.location="barangkeluar.php"</script>';
        } else {
            echo 'Gagal';
            header('location:barangkeluar.php');
        }
    }
}

<?php
require 'fungsi.php';
require 'cek.php';
?>
<html>

<head>
    <title>Laporan Barang Keluar</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
</head>

<body>
    <div class="container align-content-center">
        <h2 class="text-center">Laporan Stok Barang Keluar Toko Asia Jaya Motor</h2>
        <h4 class="text-center">Barang Keluar</h4>
        <div class="data-tables datatable-dark">
            <div class="row mt-4">
                <div class="col">
                    <form method="post" class="form-inline">
                        <input type="date" name="tanggal_mulai" class="form-control">
                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                        <br>
                        <button type="submit" name="saringtanggal" class="btn btn-info ml-3">Filter</button>
                    </form>
                </div>
            </div>
            <table id="tabelkeluar" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>Nama Barang</th>
                        <th>Harga Jual</th>
                        <th>Satuan</th>
                        <th>Jumlah Barang Keluar</th>
                        <th>Penerima</th>
                    </tr>
                </thead>
                <tfoot>
                </tfoot>
                <tbody>
                    <?php
                    if (isset($_POST['saringtanggal'])) {
                        $mulai = $_POST['tanggal_mulai'];
                        $selesai = $_POST['tanggal_selesai'];

                        if ($mulai != null || $selesai != null) {

                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang
                                                    AND tanggal BETWEEN '$mulai' AND DATE_ADD('$selesai', INTERVAL 1 DAY) ORDER BY idkeluar DESC");
                        } else {
                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                        }
                    } else {
                        $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                    }
                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                        $idk = $data['idkeluar'];
                        $idb = $data['idbarang'];
                        $tanggal = $data['tanggal'];
                        $namabarang = $data['namabarang'];
                        $harga_jual = $data['harga_jual'];
                        $satuan = $data['satuan'];
                        $qty = $data['qty'];
                        $penerima = $data['penerima'];
                    ?>
                        <tr>
                            <td><?php echo $tanggal; ?></td>
                            <td><?php echo $namabarang; ?></td>
                            <td>Rp <?php echo number_format($harga_jual, 0, ',', '.'); ?></td>
                            <td><?php echo $satuan; ?></td>
                            <td><?php echo $qty; ?></td>
                            <td><?php echo $penerima; ?></td>
                        </tr>
                    <?php
                    };
                    ?>
                </tbody>
            </table>

        </div>
    </div>

    <script>
        $(document).ready(function() {
            $('#tabelkeluar').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'excel', 'pdf', 'print'
                ]
            });
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"></script>



</body>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>
<html>

<head>
    <title>Laporan Barang Keluar</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
</head>

<body>
    <div class="container align-content-center">
        <h2 class="text-center">Laporan Stok Barang Keluar Toko Asia Jaya Motor</h2>
        <h4 class="text-center">Barang Keluar</h4>
        <div class="data-tables datatable-dark">
            <div class="row mt-4">
                <div class="col">
                    <form method="post" class="form-inline">
                        <input type="date" name="tanggal_mulai" class="form-control">
                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                        <br>
                        <button type="submit" name="saringtanggal" class="btn btn-info ml-3">Filter</button>
                    </form>
                </div>
            </div>
            <table id="tabelkeluar" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>Nama Barang</th>
                        <th>Harga Jual</th>
                        <th>Satuan</th>
                        <th>Jumlah Barang Keluar</th>
                        <th>Penerima</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tfoot>
                </tfoot>
                <tbody>
                    <?php
                    if (isset($_POST['saringtanggal'])) {
                        $mulai = $_POST['tanggal_mulai'];
                        $selesai = $_POST['tanggal_selesai'];

                        if ($mulai != null || $selesai != null) {

                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang
                                                    AND tanggal BETWEEN '$mulai' AND DATE_ADD('$selesai', INTERVAL 1 DAY) ORDER BY idkeluar DESC");
                        } else {
                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                        }
                    } else {
                        $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                    }
                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                        $idk = $data['idkeluar'];
                        $idb = $data['idbarang'];
                        $tanggal = $data['tanggal'];
                        $namabarang = $data['namabarang'];
                        $harga_jual = $data['harga_jual'];
                        $satuan = $data['satuan'];
                        $qty = $data['qty'];
                    ?>
                        <tr>
                            <td><?php echo $tanggal; ?></td>
                            <td><?php echo $namabarang; ?></td>
                            <td>Rp <?php echo number_format($harga_jual, 0, ',', '.'); ?></td>
                            <td><?php echo $satuan; ?></td>
                            <td><?php echo $qty; ?></td>
                            <td><?php echo $penerima; ?></td>
                        </tr>
                    <?php
                    };
                    ?>
                </tbody>
            </table>

        </div>
    </div>

    <script>
        $(document).ready(function() {
            $('#tabelkeluar').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'excel', 'pdf', 'print'
                ]
            });
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"></script>



</body>

</html>
// Fungsi mengubah barang masuk
if (isset($_POST['ubahbarangmasuk'])) {
    $idb = $_POST['idbarang'];
    $idm = $_POST['idmasuk'];
    $harga_beli = $_POST['harga_beli'];
    $nama_supplier = $_POST['nama_supplier'];
    $qty = $_POST['qty'];
    $total = $_POST['total'];

    // Ambil stok sekarang dari tabel stock
    $lihatstok = mysqli_query($conn, "SELECT stock FROM stok WHERE idbarang='$idb'");
    $stoknya = mysqli_fetch_array($lihatstok);
    $stokskrg = $stoknya['stock'];

    // Ambil qty sekarang dari tabel masuk
    $qtyskrg = mysqli_query($conn, "SELECT qty FROM `barang-masuk` WHERE idmasuk = '$idm'");
    $qtynya =  mysqli_fetch_array($qtyskrg);
    $qtyskrg = $qtynya['qty'];

    // Menghitung selisih antara qty baru dan qty saat ini
    $selisih = $qty - $qtyskrg;

    // Menghitung stok baru
    $stokbaru = $stokskrg + $selisih;

    $kurangistoknya = mysqli_query($conn, "UPDATE stok SET stock = '$stokbaru' WHERE idbarang='$idb'");
    $ubahnya = mysqli_query($conn, "UPDATE `barang-masuk` SET qty='$qty', harga_beli='$harga_beli', nama_supplier='$nama_supplier', total='$total' WHERE idmasuk = $idm");

    if ($kurangistoknya && $ubahnya) {
        echo '<script>alert("Berhasil Ubah Barang Masuk");window.location="barangmasuk.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk.php');
    }
}

//Fungsi Tampil Barang Masuk
<?php
while ($data = mysqli_fetch_array($ambilsemuadatastok)) { $idb = $data ['idbarang'];
$idm = $data ['idmasuk'];
$tanggal = $data ['tanggal'];
$namabarang = $data ['namabarang'];
$harga_beli = $data ['harga_beli'];
$satuan = $data ['satuan'];
$nama_supplier = $data ['nama_supplier'];
$qty = $data ['qty'];
$total = $data ['total'];
$status = $data ['status'];
}
?>

//Fungsi untuk menghapus barang masuk
if (isset($_POST['hapusbarangmasukpimpinan'])) {
    $idb = $_POST['idbarang'];
    $qty = $_POST['qty'];
    $idm = $_POST['idmasuk'];

    $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
    $data = mysqli_fetch_array($getdatastok);
    $stok = $data['stock'];

    $selisih = $stok - $qty;
    $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");
    $hapusdata = mysqli_query($conn, "DELETE FROM `barang-masuk` WHERE idmasuk = '$idm'");

    if ($update && $hapusdata) {
        echo '<script>alert("Berhasil Hapus Barang Masuk");window.location="barangmasuk_pimpinan.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk_pimpinan.php');
    }
}


//Fungsi Tambah Barang Masuk
//Fungsi untuk menambahkan barang masuk
if (isset($_POST['barangmasuk'])) {
    $barangnya = $_POST['barangnya'];
    $harga_beli = $_POST['harga_beli'];
    $nama_supplier = $_POST['nama_supplier'];
    $satuan = $_POST['satuan'];
    $qty = $_POST['qty'];
    $total = $_POST['total'];

    $cekstokbarang = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$barangnya'");
    $ambildatanya = mysqli_fetch_array($cekstokbarang);

    $stoksekarang = $ambildatanya['stock'];
    $tambahkanstoksekarangdenganquantity = $stoksekarang + $qty;

    $addtomasuk = mysqli_query($conn, "INSERT INTO `barang-masuk` (idbarang, harga_beli, nama_supplier, qty, total) VALUES ('$barangnya', '$harga_beli', '$nama_supplier', '$qty', '$total')");
    $updatestokmasuk = mysqli_query($conn, "UPDATE stok SET stock = '$tambahkanstoksekarangdenganquantity' WHERE idbarang = '$barangnya'");

    if ($addtomasuk && $updatestokmasuk) {
        echo '<script>alert("Berhasil Simpan Barang Masuk");window.location="barangmasuk.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk.php');
    }
}

//Fungsi untuk menambahkan barang keluar
if (isset($_POST['addbarangkeluar'])) {
    $barangnya = $_POST['barangnya'];
    $harga_jual = $_POST['harga_jual'];
    $penerima = $_POST['penerima'];
    $qty = $_POST['qty'];
    $total = $_POST['total'];

    $cekstokbarang = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$barangnya'");
    $ambildatanya = mysqli_fetch_array($cekstokbarang);

    $stoksekarang = $ambildatanya['stock'];

    if ($stoksekarang >= $qty) {
        //apabila barang cukup
        $tambahkanstoksekarangdenganquantity = $stoksekarang - $qty;

        $addtokeluar = mysqli_query($conn, "INSERT INTO `barang-keluar` (idbarang, harga_jual, penerima, qty, total) VALUES ('$barangnya', '$harga_jual', '$penerima', '$qty', '$total')");
        $updatestokmasuk = mysqli_query($conn, "UPDATE stok SET stock = '$tambahkanstoksekarangdenganquantity' WHERE idbarang = '$barangnya'");

        if ($addtokeluar && $updatestokmasuk) {
            echo '<script>alert("Berhasil Simpan Barang Keluar");window.location="barangkeluar.php"</script>';
        } else {
            echo 'Gagal';
            header('location:barangkeluar.php');
        }
    } else {
        //apabila barang tidak cukup
        echo '
        <script>
            alert("Jumlah berang keluar saat ini sudah melebihi jumlah stok tersisa");
            window.location.href= keluar.php;
        </script>
        ';
    }
}

//Fungsi Menampilkan Barang Masuk
<?php
while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
$idk = $data ['idkeluar'];
$idb = $data ['idbarang'];
$tanggal = $data ['tanggal'];
$namabarang = $data ['namabarang'];
$harga_jual = $data ['harga_jual'];
$satuan = $data ['satuan'];
$qty = $data ['qty'];
$penerima = $data ['penerima'];
$total = $data ['total'];
$status = $data ['status'];
}
?>

//Fungsi menghapus barang keluar pimpinan
if (isset($_POST['hapusbarangkeluarpimpinan'])) {
    $idb = $_POST['idbarang'];
    $qty = $_POST['qty'];
    $idk = $_POST['idkeluar'];

    $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
    $data = mysqli_fetch_array($getdatastok);
    $stok = $data['stock'];

    $selisih = $stok + $qty;
    $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");
    $hapusdata = mysqli_query($conn, "DELETE FROM `barang-keluar` WHERE idkeluar = '$idk'");

    if ($update && $hapusdata) {
        echo '<script>alert("Berhasil Hapus Barang Keluar");window.location="barangkeluar_pimpinan.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangkeluar_pimpinan.php');
    }
}

<div class="modal fade" id="ubah<?php echo $idb; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Ubah Data Barang</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <form method="post" id="ubahForm<?php echo $idb; ?>">
                                                            <div class="modal-body">
                                                                <h6>Nama Barang</h6>
                                                                <input type="text" name="namabarang" value="<?php echo $namabarang; ?>" class="form-control" required>
                                                                <br>
                                                                <h6>Jenis Barang</h6>
                                                                <select name="jenisbarang" value="<?php echo $jenisbarang; ?>" class="form-control">
                                                                    <?php
                                                                    $ambilsemuadatajenis = mysqli_query($conn, "SELECT * FROM `jenis-barang`");
                                                                    while ($datajenis = mysqli_fetch_array($ambilsemuadatajenis)) {
                                                                        $jenisbarang = $datajenis['jenisbarang'];
                                                                    ?>
                                                                        <option value="<?= $jenisbarang; ?>"><?= $jenisbarang; ?></option>
                                                                    <?php
                                                                    }
                                                                    ?>
                                                                </select>
                                                                <br>
                                                                <h6>Harga Beli</h6>
                                                                <input type="text" name="harga_beli" value="<?php echo $harga_beli; ?>" class="form-control" required>
                                                                <br>
                                                                <h6>Harga Jual</h6>
                                                                <input type="text" name="harga_jual" value="<?php echo $harga_jual; ?>" class="form-control" required>
                                                                <br>
                                                                <h6>Satuan</h6>
                                                                <select name="satuan" value="<?php echo $satuan; ?>" class="form-control">
                                                                    <?php
                                                                    $ambilsemuadatasatuan = mysqli_query($conn, "SELECT * FROM `satuan`");
                                                                    while ($datasatuan = mysqli_fetch_array($ambilsemuadatasatuan)) {
                                                                        $satuan = $datasatuan['satuan'];
                                                                    ?>
                                                                        <option value="<?= $satuan; ?>"><?= $satuan; ?></option>
                                                                    <?php
                                                                    }
                                                                    ?>
                                                                </select>
                                                                <br>
                                                                <input type="hidden" name="idbarang" value="<?php echo $idb; ?>">
                                                                <br>
                                                                <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#confirmationModal<?php echo $idb; ?>">Ubah</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Modal Konfirmasi -->
                                            <div class="modal fade" id="confirmationModal<?php echo $idb; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Konfirmasi Perubahan Data Barang</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <p>Apakah Anda yakin akan mengubah data?</p>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tidak</button>
                                                            <button type="button" name="ubabarang" class="btn btn-primary" onclick="submitForm(<?php echo $idb; ?>)">Ya</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- JavaScript untuk menangani konfirmasi dan memicu pembaruan -->
                                            <!-- JavaScript untuk menangani konfirmasi dan memicu pembaruan -->
                                            <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
                                            <script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest"></script>
                                            <script>
                                                function submitForm(id) {
                                                    console.log('Mengirim formulir untuk ID: ' + id);

                                                    // Menutup modal konfirmasi
                                                    $('#confirmationModal' + id).modal('hide');

                                                    // Memicu pengiriman formulir untuk memperbarui data
                                                    $('#ubahForm' + id).submit();
                                                }
                                            </script>

<?php
require 'fungsi.php';
require 'cek.php';
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Kartu Stok</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Karyawan Gudang</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar.php">Barang Keluar</a>
                            </div>
                        </li>
                        <a class="nav-link text-white" href="kartustok.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Kartu Stok</p>
                        </a>
                        <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                            <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                            <span style="margin-left: 10px;">Keluar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Kartu Stok</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <a href="cetaklaporanmasuk.php" class="btn btn-secondary">Cetak Laporan</a>
                            <div class="row mt-4">
                                <div class="col">
                                    <form method="post" class="form-inline">
                                        <input type="date" name="tanggal_mulai" class="form-control">
                                        <br>
                                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                                        <br>
                                        <button type="submit" name="saringtanggal" class="btn btn-info">Filter</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <table id="datatablesSimple">
                                <thead>
                                    <tr>
                                        <th>Nama Barang</th>
                                        <th>Stok Awal</th>
                                        <th>Jumlah Barang Masuk</th>
                                        <th>Jumlah Barang Keluar</th>
                                        <th>Stok Akhir</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                </tfoot>
                                <tbody>
                                    <?php
                                    $ambilsemuadatastok = mysqli_query($conn, "SELECT
                                    s.idbarang,
                                    s.namabarang,
                                    s.stock,
                                    bm.tanggal,
                                    COALESCE(SUM(bm.qty), 0) AS qty,
                                    COALESCE(SUM(bk.qty), 0) AS qty
                                FROM stok s
                                LEFT JOIN `barang-masuk` bm ON s.idbarang = bm.idbarang
                                LEFT JOIN `barang-keluar` bk ON s.idbarang = bk.idbarang
                                GROUP BY s.idbarang, s.namabarang, s.stock, bm.tanggal");

                                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                        $idb = $data['idbarang'];
                                        $namabarang = $data['namabarang'];
                                        $stock = $data['stock'];
                                        $qty = $data['qty'];
                                        $qty = $data['qty'];
                                    }
                                    ?>
                                    <td><?php echo $namabarang; ?></td>
                                    <td><?php echo $stock; ?></td>
                                    <td><?php echo $qty; ?></td>
                                    <td><?php echo $qty; ?></td>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; Toko Asia Jaya Motor 2023</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="js/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
</body>
</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Barang Keluar</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Karyawan Gudang</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar.php">Barang Keluar</a>
                            </div>
                        </li>
                        <a class="nav-link text-white" href="kartustok.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Kartu Stok</p>
                        </a>
                        <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                            <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                            <span style="margin-left: 10px;">Keluar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Barang Keluar</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <a href="cetaklaporankeluar.php" class="btn btn-secondary">Cetak Laporan</a>
                            <div class="row mt-4">
                                <div class="col">
                                    <form method="post" class="form-inline">
                                        <input type="date" name="tanggal_mulai" class="form-control">
                                        <br>
                                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                                        <br>
                                        <button type="submit" name="saringtanggal" class="btn btn-info">Filter</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <table id="datatablesSimple">
                                <thead>
                                    <tr>
                                        <th>Nama Barang</th>
                                        <th>Stok Awal</th>
                                        <th>Jumlah Barang Masuk</th>
                                        <th>Jumlah Barang Keluar</th>
                                        <th>Tanggal</th>
                                        <th>Stok Akhir</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                </tfoot>
                                <tbody>
                                    <?php
                                    $ambilsemuadatastok = mysqli_query($conn, "SELECT
                                    s.idbarang,
                                    s.namabarang,
                                    s.stock,
                                    COALESCE(SUM(bm.qty_masuk), 0) AS qty_masuk,
                                    COALESCE(SUM(bk.qty_keluar), 0) AS qty_keluar,
                                    MAX(bm.tanggal) AS tanggal,
                                    (s.stock + COALESCE(SUM(bm.qty_masuk), 0) - COALESCE(SUM(bk.qty_keluar), 0)) AS stok_akhir
                                FROM stok s
                                LEFT JOIN `barang-masuk` bm ON s.idbarang = bm.idbarang
                                LEFT JOIN `barang-keluar` bk ON s.idbarang = bk.idbarang
                                GROUP BY s.idbarang, s.namabarang, s.stock");

                                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                        $namabarang = $data['namabarang'];
                                        $stock_awal = $data['stock'];
                                        $qty_masuk = $data['qty_masuk'];
                                        $qty_keluar = $data['qty_keluar'];
                                        $tanggal = $data['tanggal'];

                                        // Hitung stok_akhir tanpa memengaruhi stok_awal
                                        $stok_akhir = $stock_awal + $qty_masuk - $qty_keluar;

                                        echo "<tr>";
                                        echo "<td>$namabarang</td>";
                                        echo "<td>$stock_awal</td>";
                                        echo "<td>$qty_masuk</td>";
                                        echo "<td>$qty_keluar</td>";
                                        echo "<td>$tanggal</td>";
                                        echo "<td>$stok_akhir</td>";
                                        echo "</tr>";
                                    }
                                    ?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; Toko Asia Jaya Motor 2023</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="js/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
</body>

</html>

//Fungsi
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    // Ambil data POST dari formulir
    $tanggal_masuk = $_POST['tanggal_masuk'];
    $tanggal_keluar = $_POST['tanggal_keluar'];

    // Periksa apakah waktu lebih dari 23:59 untuk membuat entri baru
    $waktu_masuk = strtotime($tanggal_masuk);
    $waktu_keluar = strtotime($tanggal_keluar);

    if (date('H:i', $waktu_masuk) > '23:59') {
        // Jika waktu lebih dari 23:59, buat entri baru untuk barang masuk
        // Lakukan INSERT ke tabel barang-masuk dengan waktu yang baru
        $query = "INSERT INTO `barang-masuk` (idbarang, qty_masuk, tanggal) VALUES (?, ?, ?)";
        $stmt = mysqli_prepare($conn, $query);
        mysqli_stmt_bind_param($stmt, 'iis', $idbarang, $qty_masuk, $tanggal_masuk);

        // Setel nilai parameter sesuai data POST dari formulir
        $idbarang = $_POST['idbarang'];
        $qty_masuk = $_POST['qty_masuk'];

        // Eksekusi pernyataan INSERT
        mysqli_stmt_execute($stmt);

        // Tutup pernyataan
        mysqli_stmt_close($stmt);
    }

    if (date('H:i', $waktu_keluar) > '23:59') {
        // Jika waktu lebih dari 23:59, buat entri baru untuk barang keluar
        // Lakukan INSERT ke tabel barang-keluar dengan waktu yang baru
        $query = "INSERT INTO `barang-keluar` (idbarang, qty_keluar, tanggal) VALUES (?, ?, ?)";
        $stmt = mysqli_prepare($conn, $query);
        mysqli_stmt_bind_param($stmt, 'iis', $idbarang, $qty_keluar, $tanggal_keluar);

        // Setel nilai parameter sesuai data POST dari formulir
        $idbarang = $_POST['idbarang'];
        $qty_keluar = $_POST['qty_keluar'];

        // Eksekusi pernyataan INSERT
        mysqli_stmt_execute($stmt);

        // Tutup pernyataan
        mysqli_stmt_close($stmt);
    }

    // ... (lanjutkan dengan logika lainnya)
}

<?php
require 'fungsi.php';
require 'cek.php';
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $ambilsemuadatastok = mysqli_query($conn, "SELECT idbarang FROM stok");
    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
        $idbarang = $data['idbarang'];
        $stok_akhir = $_POST['stok_' . $idbarang];

        // Update nilai stock di tabel stok
        mysqli_query($conn, "UPDATE stok SET stock = $stok_akhir WHERE idbarang = '$idbarang'");
    }
}

$ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM stok");
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Kartu Stok</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Karyawan Gudang</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar.php">Barang Keluar</a>
                            </div>
                        </li>
                        <a class="nav-link text-white" href="kartustok.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Kartu Stok</p>
                        </a>
                        <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                            <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                            <span style="margin-left: 10px;">Keluar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Kartu Stok</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <a href="cetaklaporankeluar.php" class="btn btn-secondary">Cetak Laporan</a>
                            <div class="row mt-4">
                                <div class="col">
                                    <form method="post" class="form-inline">
                                        <input type="date" name="tanggal_mulai" class="form-control">
                                        <br>
                                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                                        <br>
                                        <button type="submit" name="saringtanggal" class="btn btn-info">Filter</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <table id="datatablesSimple">
                                <thead>
                                    <tr>
                                        <th>Nama Barang</th>
                                        <th>Jumlah Barang Masuk</th>
                                        <th>Jumlah Barang Keluar</th>
                                        <th>Tanggal</th>
                                        <th>Stok Akhir</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                </tfoot>
                                <tbody>
                                    <?php
                                    $ambilsemuadatastok = mysqli_query($conn, "SELECT
                                    s.idbarang,
                                    s.namabarang,
                                    s.stock,
                                    COALESCE(SUM(bm.qty_masuk), 0) AS qty_masuk,
                                    COALESCE(SUM(bk.qty_keluar), 0) AS qty_keluar,
                                    MAX(bm.tanggal) AS tanggal,
                                    (s.stock + COALESCE(SUM(bm.qty_masuk), 0) - COALESCE(SUM(bk.qty_keluar), 0)) AS stok_akhir
                                FROM stok s
                                LEFT JOIN `barang-masuk` bm ON s.idbarang = bm.idbarang
                                LEFT JOIN `barang-keluar` bk ON s.idbarang = bk.idbarang
                                GROUP BY s.idbarang, s.namabarang, s.stock");

                                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                        $namabarang = $data['namabarang'];
                                        $qty_masuk = $data['qty_masuk'];
                                        $qty_keluar = $data['qty_keluar'];
                                        $stok_akhir = $data['stok_akhir'];
                                        $tanggal = $data['tanggal'];

                                        // Hitung stok_akhir tanpa memengaruhi stok_awal
                                        $stok_akhir = $qty_masuk - $qty_keluar;
                                        mysqli_query($conn, "UPDATE stok SET stock = $stok_akhir");
                                        echo "<tr>";
                                        echo "<td>$namabarang</td>";
                                        echo "<td>$qty_masuk</td>";
                                        echo "<td>$qty_keluar</td>";
                                        echo "<td>$tanggal</td>";
                                        echo "<td>$stok_akhir</td>";
                                        echo "</tr>";
                                    }
                                    ?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; Toko Asia Jaya Motor 2023</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="js/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
</body>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $ambilsemuadatastok = mysqli_query($conn, "SELECT idbarang FROM stok");
    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
        $idbarang = $data['idbarang'];
        $stok_akhir = $_POST['stok_' . $idbarang];

        // Update nilai stock di tabel stok
        mysqli_query($conn, "UPDATE stok SET stock = $stok_akhir WHERE idbarang = '$idbarang'");
    }
}

$ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM stok");
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Kartu Stok</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Karyawan Gudang</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar.php">Barang Keluar</a>
                            </div>
                        </li>
                        <a class="nav-link text-white" href="kartustok.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Kartu Stok</p>
                        </a>
                        <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                            <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                            <span style="margin-left: 10px;">Keluar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Kartu Stok</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <a href="cetaklaporankeluar.php" class="btn btn-secondary">Cetak Laporan</a>
                            <div class="row mt-4">
                                <div class="col">
                                    <form method="post" class="form-inline">
                                        <input type="date" name="tanggal_mulai" class="form-control">
                                        <br>
                                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                                        <br>
                                        <button type="submit" name="saringtanggal" class="btn btn-info">Filter</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <table id="datatablesSimple">
                                <thead>
                                    <tr>
                                        <th>Nama Barang</th>
                                        <th>Jumlah Barang Masuk</th>
                                        <th>Jumlah Barang Keluar</th>
                                        <th>Tanggal</th>
                                        <th>Stok Akhir</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                </tfoot>
                                <tbody>
                                    <?php
                                    $ambilsemuadatastok = mysqli_query($conn, "SELECT
                                    s.idbarang,
                                    s.namabarang,
                                    s.stock,
                                    COALESCE(SUM(bm.qty_masuk), 0) AS qty_masuk,
                                    COALESCE(SUM(bk.qty_keluar), 0) AS qty_keluar,
                                    MAX(bm.tanggal) AS tanggal,
                                    (s.stock + COALESCE(SUM(bm.qty_masuk), 0) - COALESCE(SUM(bk.qty_keluar), 0)) AS stok_akhir
                                FROM stok s
                                LEFT JOIN `barang-masuk` bm ON s.idbarang = bm.idbarang
                                LEFT JOIN `barang-keluar` bk ON s.idbarang = bk.idbarang
                                GROUP BY s.idbarang, s.namabarang, s.stock");

                                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                        $idb = $data['idbarang'];
                                        $namabarang = $data['namabarang'];
                                        $qty_masuk = $data['qty_masuk'];
                                        $qty_keluar = $data['qty_keluar'];
                                        $stok_akhir = $data['stok_akhir'];
                                        $tanggal = $data['tanggal'];

                                        // Hitung stok_akhir tanpa memengaruhi stok_awal
                                        $stok_akhir = $qty_masuk - $qty_keluar;
                                        mysqli_query($conn, "UPDATE stok SET stock = $stok_akhir WHERE idbarang = '{$data['idbarang']}'");
                                        echo "<tr>";
                                        echo "<td>$namabarang</td>";
                                        echo "<td>$qty_masuk</td>";
                                        echo "<td>$qty_keluar</td>";
                                        echo "<td>$tanggal</td>";
                                        echo "<td>$stok_akhir</td>";
                                        echo "</tr>";
                                    }
                                    ?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; Toko Asia Jaya Motor 2023</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="js/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
</body>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Stok Barang</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Karyawan Gudang</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar.php">Barang Keluar</a>
                            </div>
                            <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                                <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                                <span style="margin-left: 10px;">Keluar</span>
                            </button>
                        </li>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Data Barang</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#myModal">
                                Tambah Barang
                            </button>
                            <a href="cetaklaporanstok.php" class="btn btn-secondary">Cetak Laporan</a>
                        </div>
                        <div class="card-body">
                            <?php
                            $ambildatastok = mysqli_query($conn, "select * from stok where stock <= 3");

                            while ($fetch =  mysqli_fetch_array($ambildatastok)) {
                                $barang = $fetch['namabarang'];
                                $stock = $fetch['stock'];
                            ?>
                                <div class="alert alert-danger" role="alert">
                                    <strong>Perhatian!</strong> Stok <?php echo $barang; ?> tersisa <?php echo $stock; ?> harap segera dipesan kembali melalui supplier !
                                </div>
                            <?php
                            }
                            ?>
                            <div class="table-responsive">
                                <table id="datatablesSimple">
                                    <thead>
                                        <tr>
                                            <th>No</th>
                                            <th>Nama Barang</th>
                                            <th>Jenis Barang</th>
                                            <th>Harga Beli</th>
                                            <th>Harga Jual</th>
                                            <th>Satuan</th>
                                            <th>Jumlah Stok</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                    </tfoot>
                                    <tbody>
                                        <?php
                                        $ambilsemuadatastok = mysqli_query($conn, "select * from stok");
                                        $i = 1;
                                        while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                            $namabarang = $data['namabarang'];
                                            $jenisbarang = $data['jenisbarang'];
                                            $harga_beli = $data['harga_beli'];
                                            $harga_jual = $data['harga_jual'];
                                            $satuan = $data['satuan'];
                                            $keterangan = $data['keterangan'];
                                            $Tanggal_Expired = $data['Tanggal_Expired'];
                                            $stock = $data['stock'];
                                            $idb = $data['idbarang'];
                                        ?>
                                            <tr>
                                                <td><?php echo $i++; ?></td>
                                                <td><?php echo $namabarang; ?></td>
                                                <td><?php echo $jenisbarang; ?></td>
                                                <td>Rp <?php echo number_format(floatval($harga_beli), 0, ',', '.'); ?></td>
                                                <td>Rp <?php echo number_format(floatval($harga_jual), 0, ',', '.'); ?></td>
                                                <td><?php echo $satuan; ?></td>
                                                <td><?php echo $stock; ?></td>
                                                <td>
                                                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#lihatdata<?php echo $idb; ?>">
                                                        Lihat
                                                    </button>
                                                    <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#ubah<?php echo $idb; ?>">
                                                        Ubah
                                                    </button>
                                                    <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#hapus<?php echo $idb; ?>">
                                                        Hapus
                                                    </button>
                                                </td>
                                            </tr>
                                            <div class="modal fade" id="lihatdata<?php echo $idb; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Lihat Data Barang</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <form method="post">
                                                            <div class="modal-body">
                                                                <div class="row">
                                                                    <div class="col-sm-4">
                                                                        Nama Barang<br>
                                                                        Jenis Barang<br>
                                                                        Harga Beli<br>
                                                                        Harga Jual<br>
                                                                        Satuan<br>
                                                                        Jumlah Stok<br>
                                                                        Keterangan<br>
                                                                        Tanggal Expired<br>
                                                                    </div>
                                                                    <div class="col"> <strong>
                                                                        : <?php echo $namabarang; ?> <br>
                                                                        : <?php echo $jenisbarang; ?> <br>
                                                                        : Rp <?php echo number_format(floatval($harga_beli), 0, ',', '.'); ?> <br>
                                                                        : Rp <?php echo number_format(floatval($harga_jual), 0, ',', '.'); ?> <br>
                                                                        : <?php echo $satuan; ?> <br>
                                                                        : <?php echo $stock; ?> <br>
                                                                        : <?php echo $keterangan; ?> <br>
                                                                        : <?php echo $Tanggal_Expired; ?> <br>
                                                                        </strong>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal fade" id="ubah<?php echo $idb; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Ubah Data Barang</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <form method="post">
                                                            <div class="modal-body">
                                                                <h6>Nama Barang</h6>
                                                                <input type="text" name="namabarang" value="<?php echo $namabarang; ?>" class="form-control" required>
                                                                <br>
                                                                <h6>Jenis Barang</h6>
                                                                <select name="jenisbarang" value="<?php echo $jenisbarang; ?>" class="form-control">
                                                                    <?php
                                                                    $ambilsemuadatajenis = mysqli_query($conn, "SELECT * FROM `jenis-barang`");
                                                                    while ($datajenis = mysqli_fetch_array($ambilsemuadatajenis)) {
                                                                        $jenisbarang = $datajenis['jenisbarang'];
                                                                    ?>
                                                                        <option value="<?= $jenisbarang; ?>"><?= $jenisbarang; ?></option>
                                                                    <?php
                                                                    }
                                                                    ?>
                                                                </select>
                                                                <br>
                                                                <h6>Harga Beli</h6>
                                                                <input type="number" name="harga_beli" id="harga_beli_ubah" value="<?php echo $harga_beli; ?>" class="form-control" required>
                                                                <br>
                                                                <h6>Harga Jual</h6>
                                                                <input type="number" name="harga_jual" id="harga_jual_ubah" value="<?php echo $harga_jual; ?>" class="form-control" required>
                                                                <br>
                                                                <h6>Satuan</h6>
                                                                <select name="satuan" value="<?php echo $satuan; ?>" class="form-control">
                                                                    <?php
                                                                    $ambilsemuadatasatuan = mysqli_query($conn, "SELECT * FROM `satuan`");
                                                                    while ($datasatuan = mysqli_fetch_array($ambilsemuadatasatuan)) {
                                                                        $satuan = $datasatuan['satuan'];
                                                                    ?>
                                                                        <option value="<?= $satuan; ?>"><?= $satuan; ?></option>
                                                                    <?php
                                                                    }
                                                                    ?>
                                                                </select>
                                                                <br>
                                                                <h6>Keterangan</h6>
                                                                <textarea name="keterangan" placeholder="Keterangan" class="form-control"><?php echo $keterangan; ?></textarea>
                                                                <br>
                                                                <h6>Tanggal Expired</h6>
                                                                <input type="text" name="Tanggal_Expired" value="<?php echo $Tanggal_Expired; ?>" class="form-control">
                                                                <input type="hidden" name="idbarang" value="<?php echo $idb; ?>">
                                                                <br>
                                                                <button type="submit" class="btn btn-warning" name="ubahbarang" onclick="return confirm('Apakah Anda yakin akan mengubah data barang ini?')">Ubah</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal fade" id="hapus<?php echo $idb; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Hapus Data Barang</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <form method="post">
                                                            <div class="modal-body">
                                                                <p>Apakah Anda yakin ingin menghapus data barang berikut?</p>
                                                                <p><strong><?php echo $namabarang; ?></strong></p>
                                                                <input type="hidden" name="idbarang" value="<?php echo $idb; ?>">
                                                                <button type="submit" class="btn btn-danger" name="hapusbarang">Hapus</button>
                                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tidak</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        <?php
                                        }
                                        ?>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; JC Developer</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@13"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var hargaBeliUbahElement = document.getElementById('harga_beli_ubah');
            var hargaJualUbahElement = document.getElementById('harga_jual_ubah');

            function validatePositiveNumber(inputElement) {
                var inputValue = inputElement.value;

                // Memastikan nilai input tidak negatif pada form ubah
                if (inputValue < 0) {
                    // Jika negatif, set nilai input menjadi 0
                    inputElement.value = 0;
                }
            }

            hargaBeliUbahElement.addEventListener('input', function() {
                validatePositiveNumber(this);
            });

            hargaJualUbahElement.addEventListener('input', function() {
                validatePositiveNumber(this);
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var hargaBeliElement = document.getElementById('harga_beli');
            var hargaJualElement = document.getElementById('harga_jual');

            function validatePositiveNumber(inputElement) {
                var inputValue = inputElement.value;

                // Memastikan nilai input tidak negatif pada form tambah
                if (inputValue < 0) {
                    // Jika negatif, set nilai input menjadi 0
                    inputElement.value = 0;
                }
            }

            hargaBeliElement.addEventListener('input', function() {
                validatePositiveNumber(this);
            });

            hargaJualElement.addEventListener('input', function() {
                validatePositiveNumber(this);
            });
        });
    </script>
    <div class="modal fade" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h4 class="modal-title">Tambah Data Barang</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <form method="post">
                    <div class="modal-body">
                        <h6>Nama Barang</h6>
                        <input type="text" name="namabarang" placeholder="Nama Barang" class="form-control" required>
                        <br>
                        <h6>Jenis Barang</h6>
                        <select name="jenisbarang" class="form-control">
                            <?php
                            $ambilsemuadatajenis = mysqli_query($conn, "SELECT * FROM `jenis-barang`");
                            while ($datajenis = mysqli_fetch_array($ambilsemuadatajenis)) {
                                $jenisbarang = $datajenis['jenisbarang'];
                            ?>
                                <option value="<?= $jenisbarang; ?>"><?= $jenisbarang; ?></option>
                            <?php
                            }
                            ?>
                        </select>
                        <br>
                        <h6>Harga Beli</h6>
                        <input type="number" name="harga_beli" id="harga_beli" placeholder="Harga Beli" class="form-control" required>
                        <br>
                        <h6>Harga Jual</h6>
                        <input type="number" name="harga_jual" id="harga_jual" placeholder="Harga Jual" class="form-control" required>
                        <br>
                        <h6>Satuan</h6>
                        <select name="satuan" class="form-control">
                            <?php
                            $ambilsemuadatasatuan = mysqli_query($conn, "SELECT * FROM `satuan`");
                            while ($data = mysqli_fetch_array($ambilsemuadatasatuan)) {
                                $satuan = $data['satuan'];
                            ?>
                                <option value="<?= $satuan; ?>"><?= $satuan; ?></option>
                            <?php
                            }
                            ?>
                        </select>
                        <br>
                        <h6>Keterangan</h6>
                        <textarea name="keterangan" placeholder="Keterangan" class="form-control"><?php echo $keterangan; ?></textarea>
                        <br>
                        <h6>Tanggal Expired</h6>
                        <input type="text" name="Tanggal_Expired" placeholder="Tanggal Expired" class="form-control">
                        <br>
                        <input type="hidden" name="stock" value="<?php echo $stock; ?>">
                        <button type="submit" class="btn btn-success" name="addnewbarang" onclick="return confirm('Apakah Anda yakin akan menambah data barang ini?')">Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Barang Masuk</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Karyawan Gudang</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar.php">Barang Keluar</a>
                            </div>
                        </li>
                        <a class="nav-link text-white" href="kartustok.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Kartu Stok</p>
                        </a>
                        <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                            <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                            <span style="margin-left: 10px;">Keluar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Barang Masuk</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#myModal">
                                Tambah Barang Masuk
                            </button>
                            <a href="cetaklaporanmasuk.php" class="btn btn-secondary">Cetak Laporan</a>
                            <div class="row mt-4">
                                <div class="col">
                                    <form method="post" class="form-inline">
                                        <input type="date" name="tanggal_mulai" class="form-control">
                                        <br>
                                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                                        <br>
                                        <button type="submit" name="saringtanggal" class="btn btn-info">Filter</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <table id="datatablesSimple">
                                <thead>
                                    <tr>
                                        <th>Tanggal Masuk</th>
                                        <th>Nama Barang</th>
                                        <th>Harga Beli</th>
                                        <th>Satuan</th>
                                        <th>Nama Supplier</th>
                                        <th>Jumlah Barang Masuk</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                </tfoot>
                                <tbody>
                                    <?php
                                    if (isset($_POST['saringtanggal'])) {
                                        $mulai = $_POST['tanggal_mulai'];
                                        $selesai = $_POST['tanggal_selesai'];

                                        if ($mulai != null || $selesai != null) {

                                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-masuk` m, stok s WHERE s.idbarang = m.idbarang
                                                    AND tanggal BETWEEN '$mulai' AND DATE_ADD('$selesai', INTERVAL 1 DAY) ORDER BY idmasuk DESC");
                                        } else {
                                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM barang-masuk m, stok s WHERE s.idbarang = m.idbarang");
                                        }
                                    } else {
                                        $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-masuk` m, stok s WHERE s.idbarang = m.idbarang");
                                    }

                                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                        $idb = $data['idbarang'];
                                        $idm = $data['idmasuk'];
                                        $tanggal = $data['tanggal'];
                                        $namabarang = $data['namabarang'];
                                        $harga_beli = $data['harga_beli'];
                                        $satuan = $data['satuan'];
                                        $nama_supplier = $data['nama_supplier'];
                                        $qty_masuk = $data['qty_masuk'];
                                        $total = $data['total'];
                                        $status = $data['status'];
                                    ?>
                                        <td><?php echo $tanggal; ?></td>
                                        <td><?php echo $namabarang; ?></td>
                                        <td>Rp <?php echo number_format($harga_beli, 0, ',', '.'); ?></td>
                                        <td><?php echo $satuan ?></td>
                                        <td><?php echo $nama_supplier; ?></td>
                                        <td><?php echo $qty_masuk; ?></td>
                                        <td>
                                            <?php
                                            if (!empty($total) && is_numeric($total)) {
                                                echo 'Rp ' . number_format($total, 0, ',', '.');
                                            } else {
                                            }
                                            ?>
                                        </td>
                                        <td>
                                            <span style="color:
                                    <?php
                                        if ($status == 'Menunggu') {
                                            echo 'blue';
                                        } elseif ($status == 'Disetujui') {
                                            echo 'green';
                                        } elseif ($status == 'Ditolak') {
                                            echo 'red';
                                        }
                                    ?>">
                                                <?php echo $status; ?>
                                            </span>
                                        </td>

                                        </tr>
                                    <?php
                                    }
                                    ?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; JC Developer</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="js/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var qtyMasukElement = document.getElementById('qty_masuk');

            function validatePositiveNumber(inputElement) {
                var inputValue = inputElement.value;

                // Memastikan nilai input tidak negatif pada saat input jumlah stok masuk
                if (inputValue < 0) {
                    // Jika negatif, set nilai input menjadi 0
                    inputElement.value = 0;
                }
            }

            qtyMasukElement.addEventListener('input', function() {
                validatePositiveNumber(this);
            });
        });
    </script>
</body>
<!-- The Modal -->
<div class="modal fade" id="myModal">
    <div class="modal-dialog">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Tambah Barang Masuk</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <!-- Modal body -->
            <form method="post">
                <div class="modal-body">
                    <h6>Nama Barang</h6>
                    <select name="barangnya" class="form-control">
                        <?php
                        $ambilsemuadata = mysqli_query($conn, "select * from stok");
                        while ($fetcharray = mysqli_fetch_array($ambilsemuadata)) {
                            $namabarangnya = $fetcharray['namabarang'];
                            $idbarangnya = $fetcharray['idbarang'];
                        ?>

                            <option value="<?= $idbarangnya; ?>"><?= $namabarangnya; ?></option>
                        <?php
                        }
                        ?>
                    </select>
                    <br>
                    <h6>Harga beli</h6>
                    <select name="harga_beli" id="harga_beli_masuk" class="form-control">
                        <?php
                        $ambilsemuadata = mysqli_query($conn, "select * from stok");
                        while ($fetcharray = mysqli_fetch_array($ambilsemuadata)) {
                            $harga_beli = $fetcharray['harga_beli'];
                        ?>
                            <option value="<?= $harga_beli; ?>"><?= $harga_beli; ?></option>
                        <?php
                        }
                        ?>
                    </select>
                    <br>
                    <h6>Satuan</h6>
                    <select name="satuan" value="<?php echo $satuan; ?>" class="form-control">
                        <?php
                        $ambilsemuadatasatuan = mysqli_query($conn, "SELECT * FROM `satuan`");
                        $i = 1;
                        while ($data = mysqli_fetch_array($ambilsemuadatasatuan)) {
                            $satuan = $data['satuan'];
                            $ids = $data['id_satuan'];
                        ?>
                            <option value="<?= $satuan; ?>"><?= $satuan; ?></option>
                        <?php
                        }
                        ?>
                    </select>
                    <br>
                    <h6>Nama Supplier</h6>
                    <td>
                        <select name="nama_supplier" class="form-control">
                            <?php
                            $ambilsemuadatasupplier = mysqli_query($conn, "SELECT * FROM `supplier`");
                            while ($fetcharray = mysqli_fetch_array($ambilsemuadatasupplier)) {
                                $id_supplier = $fetcharray['id_supplier'];
                                $nama_supplier = $fetcharray['nama_supplier'];
                            ?>
                                <option value="<?php echo $nama_supplier; ?>"><?php echo $nama_supplier; ?></option>
                            <?php
                            }
                            ?>
                        </select>
                    </td>
                    <br>
                    <h6>Jumlah Barang Masuk</h6>
                    <input type="number" name="qty_masuk" id="qty_masuk" placeholder="Jumlah Barang Masuk" class="form-control" required>
                    <br>
                    <h6>Total</h6>
                    <input type="number" name="total" id="total_masuk" placeholder="Total" class="form-control" readonly>
                    <br>
                    <button type="submit" class="btn btn-success" name="barangmasuk" onclick="return confirm('Apakah Anda yakin akan menambah data barang masuk ini?')">Simpan</button>
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function() {
        $(document).on('change', "#qty_masuk, #harga_beli_masuk", function() {
            var qty_masuk = parseFloat($("#qty_masuk").val()) || 0;
            var harga_beli_masuk = parseFloat($("#harga_beli_masuk").val()) || 0;
            var total_masuk = qty_masuk * harga_beli_masuk;
            $("#total_masuk").val(total_masuk);
        });
    });
</script>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>
<html>

<head>
    <title>Laporan Barang Masuk</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
</head>

<body>
    <div class="container align-content-center">
        <h2 class="text-center">Laporan Stok Barang Masuk Toko Asia Jaya Motor</h2>
        <h4 class="text-center">Barang Masuk</h4>
        <div class="data-tables datatable-dark">
            <div class="row mt-4">
                <div class="col">
                    <form method="post" class="form-inline">
                        <input type="date" name="tanggal_mulai" class="form-control">
                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                        <br>
                        <button type="submit" name="saringtanggal" class="btn btn-info ml-3">Filter</button>
                    </form>
                </div>
            </div>
            <table id="tabelmasuk" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Tanggal Masuk</th>
                        <th>Nama Barang</th>
                        <th>Satuan</th>
                        <th>Nama Supplier</th>
                        <th>Jumlah Barang Masuk</th>
                    </tr>
                </thead>
                <tfoot>
                </tfoot>
                <tbody>
                    <?php
                    if (isset($_POST['saringtanggal'])) {
                        $mulai = $_POST['tanggal_mulai'];
                        $selesai = $_POST['tanggal_selesai'];

                        if ($mulai != null || $selesai != null) {

                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-masuk` m, stok s WHERE s.idbarang = m.idbarang
                                                    AND tanggal BETWEEN '$mulai' AND DATE_ADD('$selesai', INTERVAL 1 DAY) ORDER BY idmasuk DESC");
                        } else {
                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-masuk` m, stok s WHERE s.idbarang = m.idbarang");
                        }
                    } else {
                        $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-masuk` m, stok s WHERE s.idbarang = m.idbarang");
                    }

                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                        $idb = $data['idbarang'];
                        $idm = $data['idmasuk'];
                        $tanggal = $data['tanggal'];
                        $namabarang = $data['namabarang'];
                        $satuan = $data['satuan'];
                        $nama_supplier = $data['nama_supplier'];
                        $qty_masuk = $data['qty_masuk'];
                    ?>
                        <tr>
                            <td><?php echo $tanggal; ?></td>
                            <td><?php echo $namabarang; ?></td>
                            <td><?php echo $satuan; ?></td>
                            <td><?php echo $nama_supplier; ?></td>
                            <td><?php echo $qty_masuk; ?></td>
                        </tr>
                    <?php
                    };
                    ?>
                </tbody>
            </table>

        </div>
    </div>

    <script>
        $(document).ready(function() {
            $('#tabelmasuk').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'excel', 'pdf', 'print'
                ]
            });
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"></script>



</body>

</html>

<?php
session_start();

$conn = mysqli_connect("localhost", "root", "", "stokbarang");

//Fungsi untuk menambahkan data barang
if (isset($_POST['addnewbarang'])) {
    $namabarang = $_POST['namabarang'];
    $jenisbarang = $_POST['jenisbarang'];
    $harga_beli = $_POST['harga_beli'];
    $harga_jual = $_POST['harga_jual'];
    $satuan = $_POST['satuan'];
    $keterangan = $_POST['keterangan'];
    $Tanggal_Expired = $_POST['Tanggal_Expired'];
    $stock = $_POST['stock'];

    $addtotable = mysqli_query($conn, "insert into stok(namabarang, jenisbarang, harga_beli, harga_jual, satuan, keterangan, Tanggal_Expired, stock) values('$namabarang','$jenisbarang', '$harga_beli', '$harga_jual', '$satuan','$keterangan','$Tanggal_Expired', '$stock')");
    if ($addtotable) {
        echo '<script>alert("Berhasil Simpan Data Barang");window.location="databarang.php"</script>';
    } else {
        echo 'Gagal';
        header('location:databarang.php');
    }
}



//Fungsi untuk mengubah data barang
if (isset($_POST['ubahbarang'])) {
    $namabarang = $_POST['namabarang'];
    $jenisbarang = $_POST['jenisbarang'];
    $harga_beli = $_POST['harga_beli'];
    $harga_jual = $_POST['harga_jual'];
    $satuan = $_POST['satuan'];
    $keterangan = $_POST['keterangan'];
    $Tanggal_Expired = $_POST['Tanggal_Expired'];
    $idb = $_POST['idbarang'];

    $ubahbarang = mysqli_query($conn, "UPDATE stok SET namabarang='$namabarang', jenisbarang='$jenisbarang', harga_beli='$harga_beli', harga_jual='$harga_jual', satuan='$satuan', keterangan='$keterangan', Tanggal_Expired='$Tanggal_Expired' WHERE idbarang = $idb");
    if ($ubahbarang) {
        echo '<script>alert("Berhasil Ubah Data Barang");window.location="databarang.php"</script>';
    } else {
        echo 'Gagal';
        header('location:databarang.php');
    }
}

//Fungsi menhapus data barang
if (isset($_POST['hapusbarang'])) {
    $idb = $_POST['idbarang'];

    $hapusbarang = mysqli_query($conn, "DELETE from stok WHERE idbarang = '$idb'");
    if ($hapusbarang) {
        echo '<script>alert("Berhasil Hapus Data Barang");window.location="databarang.php"</script>';
    } else {
        echo 'Gagal';
        header('location:databarang.php');
    }
}

//Fungsi untuk menambahkan barang masuk
if (isset($_POST['barangmasuk'])) {
    $barangnya = $_POST['barangnya'];
    $harga_beli = $_POST['harga_beli'];
    $nama_supplier = $_POST['nama_supplier'];
    $satuan = $_POST['satuan'];
    $qty_masuk = $_POST['qty_masuk'];
    $total = $_POST['total'];

    $cekstokbarang = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$barangnya'");
    $ambildatanya = mysqli_fetch_array($cekstokbarang);

    $stoksekarang = $ambildatanya['stock'];
    $tambahkanstoksekarangdenganquantity = $stoksekarang + $qty_masuk;

    $addtomasuk = mysqli_query($conn, "INSERT INTO `barang-masuk` (idbarang, harga_beli, nama_supplier, qty_masuk, total) VALUES ('$barangnya', '$harga_beli', '$nama_supplier', '$qty_masuk', '$total')");
    $updatestokmasuk = mysqli_query($conn, "UPDATE stok SET stock = '$tambahkanstoksekarangdenganquantity' WHERE idbarang = '$barangnya'");

    if ($addtomasuk && $updatestokmasuk) {
        echo '<script>alert("Berhasil Simpan Barang Masuk");window.location="barangmasuk.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk.php');
    }
}

//Fungsi untuk menghapus barang masuk
if (isset($_POST['hapusbarangmasuk'])) {
    $idb = $_POST['idbarang'];
    $qty_masuk = $_POST['qty_masuk'];
    $idm = $_POST['idmasuk'];

    $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
    $data = mysqli_fetch_array($getdatastok);
    $stok = $data['stock'];

    $selisih = $stok - $qty_masuk;
    $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");
    $hapusdata = mysqli_query($conn, "DELETE FROM `barang-masuk` WHERE idmasuk = '$idm'");

    if ($update && $hapusdata) {
        echo '<script>alert("Berhasil Hapus Barang Masuk");window.location="barangmasuk.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk.php');
    }
}

//Fungsi untuk menambahkan barang keluar
if (isset($_POST['addbarangkeluar'])) {
    $barangnya = $_POST['barangnya'];
    $harga_jual = $_POST['harga_jual'];
    $penerima = $_POST['penerima'];
    $qty_keluar = $_POST['qty_keluar'];
    $tanggal_expired = $_POST['tanggal_expired'];
    $total = $_POST['total'];

    $cekstokbarang = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$barangnya'");
    $ambildatanya = mysqli_fetch_array($cekstokbarang);

    $stoksekarang = $ambildatanya['stock'];

    if ($stoksekarang >= $qty_keluar) {
        //apabila barang cukup
        $tambahkanstoksekarangdenganquantity = $stoksekarang - $qty_keluar;

        $addtokeluar = mysqli_query($conn, "INSERT INTO `barang-keluar` (idbarang, harga_jual, penerima, qty_keluar, tanggal_expired ,total) VALUES ('$barangnya', '$harga_jual', '$penerima', '$qty_keluar', '$tanggal_expired', '$total')");
        $updatestokmasuk = mysqli_query($conn, "UPDATE stok SET stock = '$tambahkanstoksekarangdenganquantity' WHERE idbarang = '$barangnya'");

        if ($addtokeluar && $updatestokmasuk) {
            echo '<script>alert("Berhasil Simpan Barang Keluar");window.location="barangkeluar.php"</script>';
        } else {
            echo 'Gagal';
            header('location:barangkeluar.php');
        }
    } else {
        //apabila barang tidak cukup
        echo '
        <script>
            alert("Jumlah berang keluar saat ini sudah melebihi jumlah stok tersisa");
            window.location.href= keluar.php;
        </script>
        ';
    }
}

//Fungsi menghapus barang keluar
if (isset($_POST['hapusbarangkeluar'])) {
    $idb = $_POST['idbarang'];
    $qty_keluar = $_POST['qty_keluar'];
    $idk = $_POST['idkeluar'];

    $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
    $data = mysqli_fetch_array($getdatastok);
    $stok = $data['stock'];

    $selisih = $stok + $qty_keluar;
    $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");
    $hapusdata = mysqli_query($conn, "DELETE FROM `barang-keluar` WHERE idkeluar = '$idk'");

    if ($update && $hapusdata) {
        echo '<script>alert("Berhasil Hapus Barang Keluar");window.location="barangkeluar.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangkeluar.php');
    }
}

// Fungsi untuk menambahkan jenis barang
if (isset($_POST['jenisbarangmasuk'])) {
    $jenisbarang = $_POST['jenisbarang'];
    $addjenis = mysqli_query($conn, "INSERT INTO `jenis-barang` (`jenisbarang`) VALUES ('$jenisbarang')");

    if ($addjenis) {
        echo '<script>alert("Berhasil Simpan Jenis Barang ");window.location="jenis-barang.php"</script>';
    } else {
        echo 'Gagal';
        header('location: jenis-barang.php');
    }
}

// Fungsi untuk mengubah jenis barang
if (isset($_POST['ubahjenis'])) {
    $id_jenis = $_POST['id_jenis'];
    $jenisbarang = $_POST['jenisbarang'];
    $updatejenis = mysqli_query($conn, "UPDATE `jenis-barang` SET `jenisbarang`='$jenisbarang' WHERE `id_jenis`='$id_jenis'");

    if ($updatejenis) {
        echo '<script>alert("Berhasil Ubah Jenis Barang");window.location="jenis-barang.php"</script>';
    } else {
        echo 'Gagal';
        header('location: jenis-barang.php');
    }
}
// Fungsi untuk menghapus jenis barang
if (isset($_POST['hapusjenis'])) {
    $id_jenis = $_POST['id_jenis'];
    $hapusjenis = mysqli_query($conn, "DELETE FROM `jenis-barang` WHERE `id_jenis`='$id_jenis'");

    if ($hapusjenis) {
        echo '<script>alert("Berhasil Hapus Jenis Barang");window.location="jenis-barang.php"</script>';
    } else {
        echo 'Gagal';
        header('location: jenis-barang.php');
    }
}

// Fungsi untuk menambahkan data supplier
if (isset($_POST['supplierbarang'])) {
    $nama_supplier = $_POST['nama_supplier'];
    $alamat_supplier = $_POST['alamat_supplier'];
    $no_telephone = $_POST['no_telephone'];
    $keterangan = $_POST['keterangan'];

    $addsupplier = mysqli_query($conn, "INSERT INTO `supplier` (`nama_supplier`, `alamat_supplier`, `no_telephone`, `keterangan`) VALUES ('$nama_supplier', '$alamat_supplier', '$no_telephone', '$keterangan')");

    if ($addsupplier) {
        echo '<script>alert("Berhasil Simpan Data Supplier ");window.location="supplier.php"</script>';
    } else {
        echo 'Gagal';
        header('location: supplier.php');
    }
}

// Fungsi untuk mengubah data supplier
if (isset($_POST['ubahsupplier'])) {
    $ids = $_POST['id_supplier'];
    $nama_supplier = $_POST['nama_supplier'];
    $alamat_supplier = $_POST['alamat_supplier'];
    $no_telephone = $_POST['no_telephone'];
    $keterangan = $_POST['keterangan'];
    $updatesupplier = mysqli_query($conn, "UPDATE `supplier` SET `nama_supplier`='$nama_supplier', `alamat_supplier`='$alamat_supplier', `no_telephone`='$no_telephone', `keterangan`='$keterangan' WHERE `id_supplier`='$ids'");

    if ($updatesupplier) {
        echo '<script>alert("Berhasil Ubah Data Supplier ");window.location="supplier.php"</script>';
    } else {
        echo 'Gagal';
        header('location: supplier.php');
    }
}

// Fungsi untuk menghapus data supplier
if (isset($_POST['hapussupplier'])) {
    $id_supplier = $_POST['id_supplier'];

    $hapussupplier = mysqli_query($conn, "DELETE FROM `supplier` WHERE `id_supplier`='$id_supplier'");

    if ($hapussupplier) {
        echo '<script>alert("Berhasil Hapus Data Supplier ");window.location="supplier.php"</script>';
    } else {
        echo 'Gagal';
        header('location: supplier.php');
    }
}

// Fungsi untuk menambahkan satuan barang
if (isset($_POST['satuanbarangmasuk'])) {
    $satuan = $_POST['satuan'];
    $satuanbarangmasuk = mysqli_query($conn, "INSERT INTO `satuan` (`satuan`) VALUES ('$satuan')");

    if ($satuanbarangmasuk) {
        echo '<script>alert("Berhasil Simpan Satuan Barang ");window.location="satuan.php"</script>';
    } else {
        echo 'Gagal';
        header('location: satuan.php');
    }
}

// Fungsi untuk mengubah satuan barang
if (isset($_POST['ubahsatuan'])) {
    $id_satuan = $_POST['id_satuan'];
    $satuan = $_POST['satuan'];
    $ubahsatuan = mysqli_query($conn, "UPDATE `satuan` SET `satuan`='$satuan' WHERE `id_satuan`='$id_satuan'");

    if ($ubahsatuan) {
        echo '<script>alert("Berhasil Ubah Satuan Barang ");window.location="satuan.php"</script>';
    } else {
        echo 'Gagal';
        header('location: satuan.php');
    }
}

// Fungsi untuk menghapus satuan barang
if (isset($_POST['hapussatuan'])) {
    $id_satuan = $_POST['id_satuan'];
    $hapussatuan = mysqli_query($conn, "DELETE FROM `satuan` WHERE `id_satuan`='$id_satuan'");

    if ($hapussatuan) {
        echo '<script>alert("Berhasil Hapus Satuan Barang ");window.location="satuan.php"</script>';
    } else {
        echo 'Gagal';
        header('location: satuan.php');
    }
}

//Melakukan Validasi Persetujuan Barang Masuk Oleh Pimpinan
if (isset($_POST['approvebarangmasuk'])) {
    // Memastikan $idm adalah integer
    $idm = (int)$_POST['idmasuk'];

    // Lakukan query untuk mengubah status barang masuk menjadi "Approved" dalam database
    $query = "UPDATE `barang-masuk` SET status = 'Disetujui' WHERE idmasuk = ?";

    // Membuat prepared statement
    $stmt = mysqli_prepare($conn, $query);
    mysqli_stmt_bind_param($stmt, "i", $idm);

    if (mysqli_stmt_execute($stmt)) {
        echo "<script>
            alert('Barang masuk disetujui.');
            window.location.href = 'barangmasuk_pimpinan.php';
        </script>";
        exit;
    } else {
        echo "Error: " . mysqli_error($conn);
    }

    // Tutup prepared statement
    mysqli_stmt_close($stmt);
}

//Melakukan Validasi Penolakan Barang Masuk Oleh Pimpinan
if (isset($_POST['tolakbarangmasuk'])) {
    $idb = $_POST['idbarang'];
    $qty_masuk = $_POST['qty_masuk'];
    $idm = $_POST['idmasuk'];
    // Memastikan $idk adalah integer
    $idm = (int)$_POST['idmasuk'];

    // Lakukan query untuk mengubah status barang keluar menjadi "Ditolak" dalam database
    $query = "UPDATE `barang-masuk` SET status = 'Ditolak' WHERE idmasuk = ?";

    // Membuat prepared statement
    $stmt = mysqli_prepare($conn, $query);

    if ($stmt) {
        mysqli_stmt_bind_param($stmt, "i", $idm);

        if (mysqli_stmt_execute($stmt)) {
            // Dapatkan informasi stok dari database
            $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
            $data = mysqli_fetch_array($getdatastok);
            $stok = $data['stock'];

            // Update stok dengan menambahkan kembali barang yang ditolak
            $selisih = $stok - $qty_masuk;
            $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");

            if ($update) {
                echo "<script>
                    alert('Barang masuk ditolak dan stok diperbarui.');
                    window.location.href = 'barangmasuk_pimpinan.php';
                </script>";
                exit;
            } else {
                echo "Error updating stock: " . mysqli_error($conn);
            }
        } else {
            echo "Error rejecting: " . mysqli_error($conn);
        }

        // Tutup prepared statement
        mysqli_stmt_close($stmt);
    } else {
        echo "Error in preparing the statement.";
    }
}

//Fungsi untuk menghapus barang masuk
if (isset($_POST['hapusbarangmasukpimpinan'])) {
    $idb = $_POST['idbarang'];
    $qty_masuk = $_POST['qty_masuk'];
    $idm = $_POST['idmasuk'];

    $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
    $data = mysqli_fetch_array($getdatastok);
    $stok = $data['stock'];

    $selisih = $stok - $qty_masuk;
    $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");
    $hapusdata = mysqli_query($conn, "DELETE FROM `barang-masuk` WHERE idmasuk = '$idm'");

    if ($update && $hapusdata) {
        echo '<script>alert("Berhasil Hapus Barang Masuk");window.location="barangmasuk_pimpinan.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangmasuk_pimpinan.php');
    }
}


// Melakukan Validasi Persetujuan Barang Keluar Oleh Pimpinan
if (isset($_POST['approvebarangkeluar'])) {
    // Memastikan $idk adalah integer
    $idm = (int)$_POST['idkeluar'];

    // Lakukan query untuk mengubah status barang keluar menjadi "Disetujui" dalam database
    $query = "UPDATE `barang-keluar` SET status = 'Disetujui' WHERE idkeluar = ?";

    // Membuat prepared statement
    $stmt = mysqli_prepare($conn, $query);
    mysqli_stmt_bind_param($stmt, "i", $idm);

    if (mysqli_stmt_execute($stmt)) {
        echo "<script>
            alert('Barang keluar disetujui.');
            window.location.href = 'barangkeluar_pimpinan.php';
        </script>";
        exit;
        header('Location: barangkeluar_pimpinan.php');
    } else {
        echo "Error: " . mysqli_error($conn);
    }

    // Tutup prepared statement
    mysqli_stmt_close($stmt);
}

// Melakukan Validasi Penolakan Barang Keluar Oleh Pimpinan
if (isset($_POST['tolakbarangkeluar'])) {
    $idb = $_POST['idbarang'];
    $qty_keluar = $_POST['qty_keluar'];
    $idk = $_POST['idkeluar'];
    // Memastikan $idk adalah integer
    $idk = (int)$_POST['idkeluar'];

    // Lakukan query untuk mengubah status barang keluar menjadi "Ditolak" dalam database
    $query = "UPDATE `barang-keluar` SET status = 'Ditolak' WHERE idkeluar = ?";

    // Membuat prepared statement
    $stmt = mysqli_prepare($conn, $query);

    if ($stmt) {
        mysqli_stmt_bind_param($stmt, "i", $idk);

        if (mysqli_stmt_execute($stmt)) {
            // Dapatkan informasi stok dari database
            $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
            $data = mysqli_fetch_array($getdatastok);
            $stok = $data['stock'];

            // Update stok dengan menambahkan kembali barang yang ditolak
            $selisih = $stok + $qty_keluar;
            $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");

            if ($update) {
                echo "<script>
                    alert('Barang keluar ditolak dan stok diperbarui.');
                    window.location.href = 'barangkeluar_pimpinan.php';
                </script>";
                exit;
            } else {
                echo "Error updating stock: " . mysqli_error($conn);
            }
        } else {
            echo "Error rejecting: " . mysqli_error($conn);
        }

        // Tutup prepared statement
        mysqli_stmt_close($stmt);
    } else {
        echo "Error in preparing the statement.";
    }
}

//Fungsi menghapus barang keluar pimpinan
if (isset($_POST['hapusbarangkeluarpimpinan'])) {
    $idb = $_POST['idbarang'];
    $qty_keluar = $_POST['qty_keluar'];
    $idk = $_POST['idkeluar'];

    $getdatastok = mysqli_query($conn, "SELECT * FROM stok WHERE idbarang = '$idb'");
    $data = mysqli_fetch_array($getdatastok);
    $stok = $data['stock'];

    $selisih = $stok + $qty_keluar;
    $update = mysqli_query($conn, "UPDATE stok SET stock = '$selisih' WHERE idbarang = '$idb'");
    $hapusdata = mysqli_query($conn, "DELETE FROM `barang-keluar` WHERE idkeluar = '$idk'");

    if ($update && $hapusdata) {
        echo '<script>alert("Berhasil Hapus Barang Keluar");window.location="barangkeluar_pimpinan.php"</script>';
    } else {
        echo 'Gagal';
        header('location:barangkeluar_pimpinan.php');
    }
}

//Menampilkan jumlah data jenis barang di menu beranda
// Query untuk menghitung jumlah data jenis barang
$query = "SELECT COUNT(*) as jenisbarang FROM `jenis-barang`";
$result = mysqli_query($conn, $query);

// Ambil hasil query
if ($result) {
    $row = mysqli_fetch_assoc($result);
    $jenisbarang = $row['jenisbarang'];
} else {
    $jenisbarang = 0; // Jika terjadi kesalahan, jumlah default adalah 0
}

//Menampilkan jumlah data supplier di menu beranda
// Query untuk menghitung jumlah data supplier barang
$query = "SELECT COUNT(*) as nama_supplier FROM `supplier`";
$result = mysqli_query($conn, $query);

// Ambil hasil query
if ($result) {
    $row = mysqli_fetch_assoc($result);
    $nama_supplier = $row['nama_supplier'];
} else {
    $nama_supplier = 0; // Jika terjadi kesalahan, jumlah default adalah 0
}

//Menampilkan jumlah data satuan barang di menu beranda
// Query untuk menghitung jumlah data satuan barang
$query = "SELECT COUNT(*) as satuan FROM `satuan`";
$result = mysqli_query($conn, $query);

// Ambil hasil query
if ($result) {
    $row = mysqli_fetch_assoc($result);
    $satuan = $row['satuan'];
} else {
    $satuan = 0; // Jika terjadi kesalahan, jumlah default adalah 0
}

<?php
require 'fungsi.php';
require 'cek.php';
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Barang Keluar</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Karyawan Gudang</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar.php">Barang Keluar</a>
                            </div>
                        </li>
                        <a class="nav-link text-white" href="kartustok.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Kartu Stok</p>
                        </a>
                        <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                            <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                            <span style="margin-left: 10px;">Keluar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Barang Keluar</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#myModal">
                                Tambah Barang Keluar
                            </button>
                            <a href="cetaklaporankeluar.php" class="btn btn-secondary">Cetak Laporan</a>
                            <div class="row mt-4">
                                <div class="col">
                                    <form method="post" class="form-inline">
                                        <input type="date" name="tanggal_mulai" class="form-control">
                                        <br>
                                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                                        <br>
                                        <button type="submit" name="saringtanggal" class="btn btn-info">Filter</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <table id="datatablesSimple">
                                <thead>
                                    <tr>
                                        <th>Tanggal Keluar</th>
                                        <th>Nama Barang</th>
                                        <th>Harga Jual</th>
                                        <th>Satuan</th>
                                        <th>Jumlah Barang Keluar</th>
                                        <th>Tanggal Expired</th>
                                        <th>Penerima</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                </tfoot>
                                <tbody>
                                    <?php
                                    if (isset($_POST['saringtanggal'])) {
                                        $mulai = $_POST['tanggal_mulai'];
                                        $selesai = $_POST['tanggal_selesai'];

                                        if ($mulai != null || $selesai != null) {

                                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang
                                                    AND tanggal BETWEEN '$mulai' AND DATE_ADD('$selesai', INTERVAL 1 DAY) ORDER BY idkeluar DESC");
                                        } else {
                                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                                        }
                                    } else {
                                        $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                                    }
                                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                        $idk = $data['idkeluar'];
                                        $idb = $data['idbarang'];
                                        $tanggal = $data['tanggal'];
                                        $namabarang = $data['namabarang'];
                                        $harga_jual = $data['harga_jual'];
                                        $satuan = $data['satuan'];
                                        $qty_keluar = $data['qty_keluar'];
                                        $tanggal_expired = $data['tanggal_expired'];
                                        $penerima = $data['penerima'];
                                        $total = $data['total'];
                                        $status = $data['status'];
                                    ?>
                                        <td><?php echo $tanggal; ?></td>
                                        <td><?php echo $namabarang; ?></td>
                                        <td>Rp <?php echo number_format($harga_jual, 0, ',', '.'); ?></td>
                                        <td><?php echo $satuan; ?></td>
                                        <td><?php echo $qty_keluar; ?></td>
                                        <td><?php echo $tanggal_expired ?></td>
                                        <td><?php echo $penerima; ?></td>
                                        <td>
                                            <?php
                                            if (!empty($total) && is_numeric($total)) {
                                                echo 'Rp ' . number_format($total, 0, ',', '.');
                                            } else {
                                            }
                                            ?>
                                        </td>
                                        <td>
                                            <span style="color:
                                                <?php
                                                if ($status == 'Menunggu') {
                                                    echo 'blue'; // Teks kuning untuk status 'Pending'
                                                } elseif ($status == 'Disetujui') {
                                                    echo 'green'; // Teks hijau untuk status 'Disetujui'
                                                } elseif ($status == 'Ditolak') {
                                                    echo 'red'; // Teks merah untuk status 'Ditolak'
                                                }
                                                ?>">
                                                <?php echo $status; ?>
                                            </span>
                                        </td>
                                        </tr>
                                    <?php
                                    }
                                    ?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; JC Developer</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="js/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var qtyKeluarElement = document.getElementById('qty_keluar');

            function validatePositiveNumber(inputElement) {
                var inputValue = inputElement.value;

                // Memastikan nilai input tidak negatif pada saat input jumlah stok keluar
                if (inputValue < 0) {
                    // Jika negatif, set nilai input menjadi 0
                    inputElement.value = 0;
                }
            }

            qtyKeluarElement.addEventListener('input', function() {
                validatePositiveNumber(this);
            });
        });
    </script>
    <div class="modal fade" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Tambah Barang Keluar</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <!-- Modal body -->
                <form method="post">
                    <div class="modal-body">
                        <h6>Nama Barang</h6>
                        <select name="barangnya" class="form-control">
                            <?php
                            $ambilsemuadata = mysqli_query($conn, "SELECT * FROM stok");
                            while ($fetcharray = mysqli_fetch_array($ambilsemuadata)) {
                                $namabarangnya = $fetcharray['namabarang'];
                                $idbarangnya = $fetcharray['idbarang'];
                                $stock = $fetcharray['stock'];
                                $Tanggal_Expired = $fetcharray['Tanggal_Expired'];
                            ?>
                                <option value="<?= $idbarangnya; ?>" <?php echo ($stock == 0) ? 'disabled style="color: red;"' : ''; ?>>
                                    <?= $namabarangnya . ' (' . $stock . ')' . (($stock == 0) ? ' - Stok Habis' : '  ' . $Tanggal_Expired); ?>
                                </option>
                            <?php
                            }
                            ?>
                        </select>
                        <br>
                        <h6>Harga Jual</h6>
                        <select name="harga_jual" id="harga_jual" class="form-control">
                            <?php
                            $ambilsemuadata = mysqli_query($conn, "select * from stok");
                            while ($fetcharray = mysqli_fetch_array($ambilsemuadata)) {
                                $harga_jual = $fetcharray['harga_jual'];
                            ?>

                                <option value="<?= $harga_jual; ?>"><?= $harga_jual; ?></option>
                            <?php
                            }
                            ?>
                        </select>
                        <br>
                        <h6>Satuan</h6>
                        <select name="satuan" value="<?php echo $satuan; ?>" class="form-control">
                            <?php
                            $ambilsemuadatasatuan = mysqli_query($conn, "SELECT * FROM `satuan`");
                            $i = 1;
                            while ($data = mysqli_fetch_array($ambilsemuadatasatuan)) {
                                $satuan = $data['satuan'];
                                $ids = $data['id_satuan'];
                            ?>
                                <option value="<?= $satuan; ?>"><?= $satuan; ?></option>
                            <?php
                            }
                            ?>
                        </select>
                        <br>
                        <h6>Jumlah Barang Keluar</h6>
                        <input type="number" name="qty_keluar" id="qty_keluar" placeholder="Jumlah Barang Keluar" class="form-control" required>
                        <br>
                        <h6>Tanggal_Expired</h6>
                        <input type="date" name="tanggal_expired" placeholder="Tanggal Expired" class="form-control">
                        <br>
                        <h6>Total</h6>
                        <input type="number" name="total" id="total_keluar" placeholder="Total" class="form-control" readonly>
                        <br>
                        <h6>Penerima</h6>
                        <input type="text" name="penerima" placeholder="Penerima" class="form-control" required>
                        <br>
                        <button type="submit" class="btn btn-success" name="addbarangkeluar" onclick="return confirm('Apakah Anda yakin akan menambah data barang keluar ini?')">Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            // Logika perhitungan total harga saat barang diinput
            $("#qty_keluar, #harga_jual").change(function() {
                var qty_keluar = parseFloat($("#qty_keluar").val()) || 0;
                var harga_jual = parseFloat($("#harga_jual").val()) || 0;
                var total_keluar = qty_keluar * harga_jual;
                $("#total_keluar").val(total_keluar);
            });
        });
    </script>
</body>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Barang Keluar</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .btn-info {
            background-color: #4135FF;
            color: #fff;
            margin-top: 10px !important;
            font-weight: bold;
            padding: 8px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.3s ease;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <<nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
        </nav>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                    <div class="container text-center mt-5">
                        <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                        <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Pemilik Toko</p>
                    </div>
                    <div class="sb-sidenav-menu">
                        <div class="nav">
                            <a class="nav-link text-white" href="beranda_pimpinan.php">
                                <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                                <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                            </a>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                    <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                                </a>
                                <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                    <a class="dropdown-item" href="databarang_pimpinan.php">Data Barang</a>
                                    <a class="dropdown-item" href="jenis-barang_pimpinan.php">Jenis Barang</a>
                                    <a class="dropdown-item" href="supplier_pimpinan.php">Data Supplier</a>
                                    <a class="dropdown-item" href="satuan_pimpinan.php">Satuan Barang</a>
                                </div>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                    <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                                </a>
                                <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                    <a class="dropdown-item" href="barangmasuk_pimpinan.php">Barang Masuk</a>
                                    <a class="dropdown-item" href="barangkeluar_pimpinan.php">Barang Keluar</a>
                                </div>
                            </li>
                            <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                                <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                                <span style="margin-left: 10px;">Keluar</span>
                            </button>
                        </div>
                    </div>
                </nav>
            </div>
            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid px-4">
                        <h1 class="mt-4">Barang Keluar</h1>
                        <div class="card mb-4">
                            <div class="card-header">
                                <a href="cetaklaporankeluar.php" class="btn btn-secondary">Cetak Laporan</a>
                                <div class="row mt-4">
                                    <div class="col">
                                        <form method="post" class="form-inline">
                                            <input type="date" name="tanggal_mulai" class="form-control">
                                            <br>
                                            <input type="date" name="tanggal_selesai" class="form-control ml-3">
                                            <br>
                                            <button type="submit" name="saringtanggal" class="btn btn-info">Filter</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <table id="datatablesSimple">
                                    <thead>
                                        <tr>
                                            <th>Tanggal Keluar</th>
                                            <th>Nama Barang</th>
                                            <th>Satuan</th>
                                            <th>Jumlah Barang Keluar</th>
                                            <th>Tanggal Expired</th>
                                            <th>Penerima</th>
                                            <th>Status</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                    </tfoot>
                                    <tbody>
                                        <?php
                                        if (isset($_POST['saringtanggal'])) {
                                            $mulai = $_POST['tanggal_mulai'];
                                            $selesai = $_POST['tanggal_selesai'];

                                            if ($mulai != null || $selesai != null) {

                                                $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang
                                                    AND tanggal BETWEEN '$mulai' AND DATE_ADD('$selesai', INTERVAL 1 DAY) ORDER BY idkeluar DESC");
                                            } else {
                                                $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                                            }
                                        } else {
                                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                                        }
                                        while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                            $idk = $data['idkeluar'];
                                            $idb = $data['idbarang'];
                                            $tanggal = $data['tanggal'];
                                            $namabarang = $data['namabarang'];
                                            $satuan = $data['satuan'];
                                            $qty_keluar = $data['qty_keluar'];
                                            $tanggal_expired = $data['tanggal_expired'];
                                            $penerima = $data['penerima'];
                                            $status = $data['status'];
                                        ?>
                                            <tr>
                                                <td><?php echo $tanggal; ?></td>
                                                <td><?php echo $namabarang; ?></td>
                                                <td><?php echo $satuan; ?></td>
                                                <td><?php echo $qty_keluar; ?></td>
                                                <td><?php echo $tanggal_expired ?></td>
                                                <td><?php echo $penerima; ?></td>
                                                <td>
                                                    <span style="color:
                                                    <?php
                                                    if ($status == 'Menunggu') {
                                                        echo 'blue'; // Teks kuning untuk status 'Pending'
                                                    } elseif ($status == 'Disetujui') {
                                                        echo 'green'; // Teks hijau untuk status 'Disetujui'
                                                    } elseif ($status == 'Ditolak') {
                                                        echo 'red'; // Teks merah untuk status 'Ditolak'
                                                    }
                                                    ?>">
                                                        <?php echo $status; ?>
                                                    </span>
                                                <td>
                                                    <?php
                                                    if ($status == 'Menunggu') {
                                                        echo '<button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#validasi' . $idk . '">Validasi</button>';
                                                        echo '&nbsp;';
                                                        echo '<button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#hapus' . $idk . '">Hapus</button>';
                                                    }
                                                    ?>
                                                </td>
                                            </tr>
                                            <div class="modal fade" id="validasi<?php echo $idk; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Persetujuan Barang Keluar</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <form method="post">
                                                            <div class="modal-body">
                                                                <h6>Konfirmasi persetujuan untuk barang keluar <?php echo $namabarang; ?></h6>

                                                                <input type="hidden" name="idbarang" value="<?php echo $idb; ?>">
                                                                <input type="hidden" name="idkeluar" value="<?php echo $idk; ?>">
                                                                <input type="hidden" name="qty_keluar" value="<?php echo $qty_keluar; ?>">
                                                                <button type="submit" class="btn btn-success" name="approvebarangkeluar" onclick="return confirm('Apakah Anda yakin akan menambah data barang keluar ini?')">Setujui</button>
                                                                <button type="submit" class="btn btn-danger" name="tolakbarangkeluar" onclick="return confirm('Apakah Anda yakin akan menambah data keluar masuk ini?')">Tolak</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal fade" id="hapus<?php echo $idk; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Hapus Barang Masuk</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <form method="post">
                                                            <div class="modal-body">
                                                                <p>Apakah Anda yakin ingin menghapus <?php echo $namabarang; ?> berikut?</p>
                                                                <input type="hidden" name="idbarang" value="<?php echo $idb; ?>">
                                                                <input type="hidden" name="idkeluar" value="<?php echo $idk; ?>">
                                                                <input type="hidden" name="qty_keluar" value="<?php echo $qty_keluar; ?>">
                                                                <button type="submit" class="btn btn-danger" name="hapusbarangkeluarpimpinan">Hapus</button>
                                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tidak</button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        <?php
                                        };
                                        ?>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </main>
                <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                    <div class="container-fluid px-4">
                        <div class="d-flex align-items-center justify-content-center small">
                            <div class="text-center font-weight-bold">Hak Cipta &copy; JC Developer</div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="js/scripts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
        <script src="assets/demo/chart-area-demo.js"></script>
        <script src="assets/demo/chart-bar-demo.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
        <script src="js/datatables-simple-demo.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const table = new simpleDatatables.DataTable('#datatablesSimple', {
                    labels: {
                        // Sesuaikan dengan bahasa yang diinginkan
                        placeholder: 'Cari...',
                        perPage: ' entri per halaman',
                        noRows: 'Tidak ada data untuk ditampilkan',
                        info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                    },
                });
            });
        </script>
</body>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>
<html>

<head>
    <title>Laporan Barang Keluar</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
</head>

<body>
    <div class="container align-content-center">
        <h2 class="text-center">Laporan Stok Barang Keluar Toko Asia Jaya Motor</h2>
        <h4 class="text-center">Barang Keluar</h4>
        <div class="data-tables datatable-dark">
            <div class="row mt-4">
                <div class="col">
                    <form method="post" class="form-inline">
                        <input type="date" name="tanggal_mulai" class="form-control">
                        <input type="date" name="tanggal_selesai" class="form-control ml-3">
                        <br>
                        <button type="submit" name="saringtanggal" class="btn btn-info ml-3">Filter</button>
                    </form>
                </div>
            </div>
            <table id="tabelkeluar" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Tanggal</th>
                        <th>Nama Barang</th>
                        <th>Harga Jual</th>
                        <th>Satuan</th>
                        <th>Jumlah Barang Keluar</th>
                        <th>Tanggal Expired</th>
                        <th>Penerima</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tfoot>
                </tfoot>
                <tbody>
                    <?php
                    if (isset($_POST['saringtanggal'])) {
                        $mulai = $_POST['tanggal_mulai'];
                        $selesai = $_POST['tanggal_selesai'];

                        if ($mulai != null || $selesai != null) {

                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang
                                                    AND tanggal BETWEEN '$mulai' AND DATE_ADD('$selesai', INTERVAL 1 DAY) ORDER BY idkeluar DESC");
                        } else {
                            $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                        }
                    } else {
                        $ambilsemuadatastok = mysqli_query($conn, "SELECT * FROM `barang-keluar` k, stok s WHERE s.idbarang = k.idbarang");
                    }
                    while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                        $idk = $data['idkeluar'];
                        $idb = $data['idbarang'];
                        $tanggal = $data['tanggal'];
                        $namabarang = $data['namabarang'];
                        $harga_jual = $data['harga_jual'];
                        $satuan = $data['satuan'];
                        $qty_keluar = $data['qty_keluar'];
                        $tanggal_expired = $data['tanggal_expired'];
                        $penerima = $data['penerima'];
                        $total = $data['total'];
                    ?>
                        <tr>
                            <td><?php echo $tanggal; ?></td>
                            <td><?php echo $namabarang; ?></td>
                            <td>Rp <?php echo number_format($harga_jual, 0, ',', '.'); ?></td>
                            <td><?php echo $satuan; ?></td>
                            <td><?php echo $qty_keluar; ?></td>
                            <td><?php echo $tanggal_expired ?></td>
                            <td><?php echo $penerima; ?></td>
                            <td>
                                <?php
                                if (!empty($total) && is_numeric($total)) {
                                    echo 'Rp ' . number_format($total, 0, ',', '.');
                                } else {
                                }
                                ?>
                            </td>
                        </tr>
                    <?php
                    };
                    ?>
                </tbody>
            </table>

        </div>
    </div>

    <script>
        $(document).ready(function() {
            $('#tabelkeluar').DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'excel', 'pdf', 'print'
                ]
            });
        });
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"></script>



</body>

</html>

<?php
require 'fungsi.php';
require 'cek.php';
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link href='img/logo-ajm.jpeg' rel='shortcut icon'>
    <title>Stok Barang</title>
    <style>
        .hover-effect:hover {
            font-weight: bold;
            color: black;
        }

        .navmain {
            background-color: #87CEFA
        }

        .navsecond {
            background-color: #FFEFD5
        }

        .footer {
            background-color: #87CEFA
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <script>
        function confirmLogout() {
            var result = confirm("Apakah Anda yakin ingin keluar dari aplikasi?");
            if (result) {
                window.location.href = "keluar.php";
            } else {}
        }
    </script>
</head>

<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark navmain">
        <a class="navbar-brand ps-3 text-dark" style="font-weight: bold;" href="index.php">Toko Asia Jaya Motor</a>
        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars text-dark" style="font-weight: bold;"></i></button>
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion navsecond" id="sidenavAccordion">
                <div class="container text-center mt-5">
                    <img src="./img/logo-ajm.jpeg" class="rounded-circle mx-auto" style="width: 100px; height: 100px;">
                    <p class="mt-2 text-dark fs-5" style="font-weight: bold;">Pemilik Toko</p>
                </div>
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        <a class="nav-link text-white" href="beranda_pimpinan.php">
                            <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt fs-5 text-dark"></i></div>
                            <p class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Beranda</p>
                        </a>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-database fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Data Master</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="databarang_pimpinan.php">Data Barang</a>
                                <a class="dropdown-item" href="jenis-barang_pimpinan.php">Jenis Barang</a>
                                <a class="dropdown-item" href="supplier_pimpinan.php">Data Supplier</a>
                                <a class="dropdown-item" href="satuan_pimpinan.php">Satuan Barang</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-dark" id="stokBarangDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <div class="sb-nav-link-icon"><i class="fas fa-exchange-alt fs-5 text-dark"></i></div>
                                <span class="mb-0 fs-5 hover-effect text-dark" style="font-weight: bold;">Transaksi</span>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="stokBarangDropdown">
                                <a class="dropdown-item" href="barangmasuk_pimpinan.php">Barang Masuk</a>
                                <a class="dropdown-item" href="barangkeluar_pimpinan.php">Barang Keluar</a>
                            </div>
                        </li>
                        <button onclick="confirmLogout()" class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0 text-dark fs-5" style="font-weight: bold; text-decoration: none; display: flex; align-items: center;">
                            <div class="sb-nav-link-icon"><i class="fas fa-sign-out-alt fs-5 text-dark" style="margin-left: 8px;"></i></div>
                            <span style="margin-left: 10px;">Keluar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h1 class="mt-4">Data Barang</h1>
                    <div class="card mb-4">
                        <div class="card-header">
                            <a href="cetaklaporanstok.php" class="btn btn-secondary">Cetak Laporan</a>
                        </div>
                        <div class="card-body">
                            <?php
                            $ambildatastok = mysqli_query($conn, "select * from stok where stock <= 3");

                            while ($fetch =  mysqli_fetch_array($ambildatastok)) {
                                $barang = $fetch['namabarang'];
                                $stock = $fetch['stock'];
                            ?>
                                <div class="alert alert-danger" role="alert">
                                    <strong>Perhatian!</strong> Stok <?php echo $barang; ?> tersisa <?php echo $stock; ?> harap segera dipesan kembali melalui supplier !
                                </div>
                            <?php
                            }
                            ?>
                            <div class="table-responsive">
                                <table id="datatablesSimple">
                                    <thead>
                                        <tr>
                                            <th>No</th>
                                            <th>Nama Barang</th>
                                            <th>Jenis Barang</th>
                                            <th>Harga Beli</th>
                                            <th>Harga Jual</th>
                                            <th>Satuan</th>
                                            <th>Jumlah Stok</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                    </tfoot>
                                    <tbody>
                                        <?php
                                        $ambilsemuadatastok = mysqli_query($conn, "select * from stok");
                                        $i = 1;
                                        while ($data = mysqli_fetch_array($ambilsemuadatastok)) {
                                            $namabarang = $data['namabarang'];
                                            $jenisbarang = $data['jenisbarang'];
                                            $harga_beli = $data['harga_beli'];
                                            $harga_jual = $data['harga_jual'];
                                            $satuan = $data['satuan'];
                                            $keterangan = $data['keterangan'];
                                            $Tanggal_Expired = $data['Tanggal_Expired'];
                                            $stock = $data['stock'];
                                            $idb = $data['idbarang'];
                                        ?>
                                            <tr>
                                                <td><?php echo $i++; ?></td>
                                                <td><?php echo $namabarang; ?></td>
                                                <td><?php echo $jenisbarang; ?></td>
                                                <td>Rp <?php echo number_format(floatval($harga_beli), 0, ',', '.'); ?></td>
                                                <td>Rp <?php echo number_format(floatval($harga_jual), 0, ',', '.'); ?></td>
                                                <td><?php echo $satuan; ?></td>
                                                <td><?php echo $stock; ?></td>
                                                <td>
                                                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#lihatdata<?php echo $idb; ?>">
                                                        Lihat
                                                </td>
                                            </tr>
                                            <div class="modal fade" id="lihatdata<?php echo $idb; ?>">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h4 class="modal-title">Lihat Data Barang</h4>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                        </div>
                                                        <form method="post">
                                                            <div class="modal-body">
                                                                <div class="row">
                                                                    <div class="col-sm-4">
                                                                        Nama Barang<br>
                                                                        Jenis Barang<br>
                                                                        Harga Beli<br>
                                                                        Harga Jual<br>
                                                                        Satuan<br>
                                                                        Jumlah Stok<br>
                                                                        Keterangan<br>
                                                                        Tanggal Expired<br>
                                                                    </div>
                                                                    <div class="col"> <strong>
                                                                        : <?php echo $namabarang; ?> <br>
                                                                        : <?php echo $jenisbarang; ?> <br>
                                                                        : Rp <?php echo number_format(floatval($harga_beli), 0, ',', '.'); ?> <br>
                                                                        : Rp <?php echo number_format(floatval($harga_jual), 0, ',', '.'); ?> <br>
                                                                        : <?php echo $satuan; ?> <br>
                                                                        : <?php echo $stock; ?> <br>
                                                                        : <?php echo $keterangan; ?> <br>
                                                                        : <?php echo $Tanggal_Expired; ?> <br>
                                                                        </strong>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        <?php
                                        }
                                        ?>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <footer class="py-4 mt-auto text-dark fs-5 footer" style="font-weight: bold;">
                <div class="container-fluid px-4">
                    <div class="d-flex align-items-center justify-content-center small">
                        <div class="text-center font-weight-bold">Hak Cipta &copy; JC Developer</div>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="js/scripts.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
    <script src="assets/demo/chart-area-demo.js"></script>
    <script src="assets/demo/chart-bar-demo.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="js/datatables-simple-demo.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = new simpleDatatables.DataTable('#datatablesSimple', {
                labels: {
                    // Sesuaikan dengan bahasa yang diinginkan
                    placeholder: 'Cari...',
                    perPage: ' entri per halaman',
                    noRows: 'Tidak ada data untuk ditampilkan',
                    info: 'Menampilkan {start} sampai {end} dari {rows} entri',
                },
            });
        });
    </script>
</body>

</html>

